# 3.2.1. 行动的概率结果

> 行动是不确定的。

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption><p>图2 在泥泞中行驶的移动机器人。</p></figcaption></figure>

在现实世界中，由于各种原因，机器人并不总是完美地执行动作。例如，如图 2 所示，机器人可能会尝试在户外环境中向前行驶，但车轮下的泥土可能会阻止它按预期行驶。

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption><p>图3 一个人形生物试图捡起一个物体。</p></figcaption></figure>

或者，具有关节臂的机器人（图 3）可能会尝试拾取物体，但失败了。有些物体比其他物体更容易抓握，而且机器人抓手不如人的手灵巧，所以这并不是什么罕见的事情。

同样，对于我们的扫地机器人示例，可能会发生各种问题：特定的门口可能被堵塞，机器人可能会迷路，或者它可能会采取在特定房间根本无法执行的作 - 例如在办公室执行移动。提醒一下，在本章中，我们将时间离散化，并用$$k \geq 1$$整数讨论机器人在离散化时间$$t_k$$的状态。在这里，我们不太关心 robot 完成转换的底层时间$$t_k$$，只要是在合理的时间内即可。例如，机器人控制系统可能会在多次尝试移动到其他房间失败后超时。那是另一种方式，作可能会失败。

为了模拟与执行作相关的不确定性，我们将再次使用概率语言。特别是，我们将使用条件概率$$P(X_{k+1}|X_k=x,A=a)$$来定义状态转换模型模型，即下一个状态$$X_{k+1}$$的条件概率分布，给定当前状态$$x X_k$$的值 ，以及动作$$a A$$的值。因为这个情况下的状态空间涉及到导航，所以我们也可以把对应的条件分布$$P(X_{k+1}|X_k,A)$$称为运动模型。

图 4 中的代码以大型条件概率表的形式生成了从状态$$X_1$$移动到 $$X_2$$ 的动感模型。在代码中，我们使用了两个新变量 （ `action_space` 和 `action_spec` ），它们是为我们预定义的，但为了清楚起见，它们在注释中重复出现。在 `motion_model` 代码下方呈现为一个表格，显示为$$P(X_2|X_1,A_1)$$ 所有可能$$(X_1,A_1)$$ 组合的行。

```
#| caption: The code for specifying the vacuum cleaner motion model, and the resulting CPT.
#| label: vacuum-motion-model
# vacuum.action_space = ["L","R","U","D",]
# vacuum.action_spec is a string with the transition probabilities:
#  "1/0/0/0/0 2/8/0/0/0 1/0/0/0/0 2/0/0/8/0
#   8/2/0/0/0 0/1/0/0/0 0/1/0/0/0 0/2/0/0/8
#   0/0/1/0/0 0/0/2/8/0 0/0/1/0/0 0/0/1/0/0
#   0/0/8/2/0 0/0/0/2/8 8/0/0/2/0 0/0/0/1/0
#   0/0/0/8/2 0/0/0/0/1 0/8/0/0/2 0/0/0/0/1"
X = VARIABLES.discrete_series("X", [1, 2, 3], vacuum.rooms) # states for times 1,2 and 3
A = VARIABLES.discrete_series("A", [1, 2], vacuum.action_space) # actions for times 1 and 2
motion_model = gtsam.DiscreteConditional(X[2], [X[1], A[1]], vacuum.action_spec)
pretty(motion_model)
```

|      X1     |  A1 | Living Room | Kitchen | Office | Hallway | Dining Room |
| :---------: | :-: | :---------: | :-----: | :----: | :-----: | :---------: |
| Living Room |  L  |      1      |    0    |    0   |    0    |      0      |
| Living Room |  R  |     0.20    |   0.80  |    0   |    0    |      0      |
| Living Room |  U  |      1      |    0    |    0   |    0    |      0      |
| Living Room |  D  |     0.20    |    0    |    0   |   0.80  |      0      |
|   Kitchen   |  L  |     0.80    |   0.20  |    0   |    0    |      0      |
|   Kitchen   |  R  |      0      |    1    |    0   |    0    |      0      |
|   Kitchen   |  U  |      0      |    1    |    0   |    0    |      0      |
|   Kitchen   |  D  |      0      |   0.20  |    0   |    0    |     0.80    |
|    Office   |  L  |      0      |    0    |    1   |    0    |      0      |
|    Office   |  R  |      0      |    0    |  0.20  |   0.80  |      0      |
|    Office   |  U  |      0      |    0    |    1   |    0    |      0      |
|    Office   |  D  |      0      |    0    |    1   |    0    |      0      |
|   Hallway   |  L  |      0      |    0    |  0.80  |   0.20  |      0      |
|   Hallway   |  R  |      0      |    0    |    0   |   0.20  |     0.80    |
|   Hallway   |  U  |     0.80    |    0    |    0   |   0.20  |      0      |
|   Hallway   |  D  |      0      |    0    |    0   |    1    |      0      |
| Dining Room |  L  |      0      |    0    |    0   |   0.80  |             |
| Dining Room |  R  |      0      |    0    |    0   |    0    |             |
| Dining Room |  U  |      0      |   0.80  |    0   |    0    |             |
| Dining Room |  D  |      0      |    0    |    0   |    0    |             |

当然，手动指定此表是相当乏味的。在这种情况下，对于这四个作中的每一个，我们必须计算从 5 个可能的起始 room 中的每一个到 5 个可能的目标 room 中的每一个的转换概率：entries。4\*5\*5=100\
在上面的示例中，不可能的过渡（例如，从客厅向上移动到任何其他房间）的概率为零。假设其他作有 80% 的成功机会（例如，从客厅直接移动到厨房的转换概率为$$0.80$$）。

条件概率分布不必指定为巨型表。因为状态空间可能相当大，所以这种运动模型几乎从未明确指定，而是利用状态和动作的语义来计算运行时的条件分布。例如，我们可能确定成功移动到相邻房间的概率是$$0.80$$\
，对于所有房间和所有作，而不是从每个可能的房间中列举每个可能的动作，并且未能做到这一点的概率是$$0.20$$\
。如果我们将此规则应用于作和相邻房间的每个组合，我们可以根据需要在上面的表中构建特定行。
