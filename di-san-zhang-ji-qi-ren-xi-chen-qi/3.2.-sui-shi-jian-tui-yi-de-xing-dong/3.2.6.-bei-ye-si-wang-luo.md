# 3.2.6. 贝叶斯网络

> 贝叶斯网络提供了图形语言，将条件概率串合成生成世界模型。

马尔可夫链是更通用的贝叶斯网络或贝叶斯网络的特例。贝叶斯网是一种有向无环图 （DAG），用于描述一组随机变量的因分解概率分布。术语因分解概率分布是指概率分布表示为因子的乘积，在贝叶斯网络中，因子始终是条件分布。

图 11 中的代码使用 GTSAM 创建一个贝叶斯网络，然后我们可以显示它。我们在此下方正式定义贝叶斯网。

```python
#| caption: A general Bayes net on four discrete variables.
#| label: fig:general_bayes_net
wxyz = gtsam.DiscreteBayesNet()
W1 = VARIABLES.binary("W")
X1 = VARIABLES.binary("X")
Y1 = VARIABLES.binary("Y")
Z1 = VARIABLES.binary("Z")
wxyz.add(W1, [X1, Z1], "1/1 1/1 1/1 1/1")
wxyz.add(X1, [Y1, Z1], "1/1 1/1 1/1 1/1")
wxyz.add(Y1, [Z1], "1/1 1/1")
wxyz.add(Z1, "1/1")
show(wxyz)
```

<figure><img src="../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

图 11 中的示例贝叶斯网只是哪些随机变量的 CPT（条件概率表）取决于哪些其他变量的图形表示。从形式上讲，在贝叶斯网络中，一组随机变量$$X_1,\dots,X_n$$的联合概率分布$$P(X_1,\dots,X_n)$$可以计算为与每个单个变量$$X_i$$关联的$$n$$条件概率的乘积，如下所示：

$$P(X_1,\dots,X_n)=\prod_{i=1}^n P(X_i|\prod_i)$$（公式3.13）

其中$$n$$是变量的数量，$$\prod_i$$表示有向图中 variable $$X_i$$的父项集。

在该示例中，关节分布可以读为：

$$P(W,X,Y,Z)=P(W|X,Z)P(X|Y,Z)P(Y|Z)P(Z).$$（公式3.14）

请注意，条件语句的乘法顺序无关紧要，但我们通常更喜欢将父级更靠右，如上所述。最后，请注意，上面的图有周期，但周期只在底层的无向图中，而不在有向图中。不允许有向循环，即方向不一致的循环。

贝叶斯网络可以非常有效地表示复杂概率分布，因为它们编码了变量之间的依赖关系，尤其是独立关系。上面的贝叶斯网络是在假设二进制变量的情况下创建的，因此不需要花费很多精力来指定，但正如我们在上面看到的，即使对于相对较小的状态空间，指定 CPT 的复杂性也可能令人生畏。

如果我们要为变量W、X、Y和Z的每个可能结果构建一个完整的概率表，那么该表可能会很长。例如，如果我们假设它们都有 10 个可能的值，那么表示 fulljoint 分布所需的表将包含$$10^4$$条目，即$$10,000$$唯一值。你可以节省一点点，因为它们必须求和到 1，所以严格来说我们只需要$$9,999$$\
值。相比之下，我们可以计算出上面所有四个 CPT 表的贝叶斯网有多少个条目。下表显示了这一点：

|    CPT    | entries |
| :-------: | :-----: |
|    P(Z)   |    9    |
|  P(Y\|Z)  |    90   |
| P(X\|Y,Z) |   900   |
| P(W\|X,Z) |   900   |

例如，$$P(X|Y,Z)$$有 900 个条目，即 100 种可能的组合$$Y$$和$$Z$$\
的 9 个（独立）条目。因此，我们需要的参数总数仅为$$1,899$$\
，它明显小于$$9,999$$。
