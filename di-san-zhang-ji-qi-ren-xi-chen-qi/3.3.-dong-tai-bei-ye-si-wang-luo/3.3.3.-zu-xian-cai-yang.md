# 3.3.3. 祖先采样

> 对于 DBN 来说，血统很重要！

我们如何对如此复杂的贝叶斯网进行采样？为了解释，请回顾上一节图 11 中的贝叶斯网示例。它有四个变量 W，X，Y，Z 和联合分布

$$P(W,X,Y,Z)=P(W|X,Z)P(X|Y,Z)P(Y|Z)P(Z).$$（公式3.16）

从以贝叶斯网络形式给出的联合分布中采样可以通过依次对每个变量进行采样来完成，但要确保我们始终先对节点的父节点进行采样。这可以使用 DAG 的拓扑类型的概念来完成。DAG 的拓扑排序是顶点的排序方式，$$\{v_1,\dots,v_n\}$$当 DAG 中存在 from $$v_i$$to$$v_j$$的有向边时，该$$v_i$$排序位于排序之前$$v_j$$。

获得拓扑排序的一种简单算法是 Kahn 算法，该算法以迭代方式从图中删除没有父节点或父节点已被全部删除的节点。删除节点的顺序构成（非唯一）拓扑排序顺序。

然后，通过按拓扑排序顺序分别从每个变量中采样来完成采样，因为这样做将确保每个变量的父值都已可用。如果从上到下阅读，上面的示例图恰好已经按拓扑排序顺序布局。因此，在此示例中，我们首先$$Z$$采样 ，然后$$Y$$，然后$$X$$，然后$$W$$ ，然后\
。请注意，在这种情况下，拓扑排序恰好是唯一的，但这是一个例外，而不是规则：对于任意贝叶斯网络，可以存在多个拓扑排序。
