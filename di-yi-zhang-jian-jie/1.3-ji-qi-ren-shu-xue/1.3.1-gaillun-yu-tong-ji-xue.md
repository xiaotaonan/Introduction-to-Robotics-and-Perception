# 1.3.1 概率论与统计学

> 统计学家研究数据。概率论者明白为什么这是一个好主意。

机器人通常无法获得完整且正确的环境模型。如果使用传感器来确定世界状态，传感器测量结果必然会存在误差和不确定性。例如，垃圾分类机器人有多个传感器，所有这些传感器报告的数据都会受到噪声干扰，因此这些测量结果可能会有多种可能的解释。此外，机器人自身行为的影响也可能存在不确定性，例如我们的吸尘器机器人有时无法到达其预期的目的地，或者物流机器人的运动会受到工厂车间摩擦力变化和电机性能变化等因素的影响。

概率论为不确定性的建模和推理提供了严格的数学框架。不确定性量可以用概率分布来表征，概率分布表征各种可能性的概率，例如，一块垃圾由玻璃或金属制成的概率。条件概率分布描述各种量之间关系的不确定性，例如，物体的实际重量与传感器返回的重量（例如垃圾分类机器人），或机器人行进的距离与指令运动（例如我们的物流机器人）。期望的概念量化了我们经过多次试验或多次观察后，平均预期看到的结果。例如，如果我们命令物流机器人向前移动一米并重复多次，那么机器人每一步移动的平均距离是多少。

此外，概率论提供了可靠的推理工具，例如贝叶斯定理，该定理将特定证据出现时结果的概率与该证据、结果本身以及两者之间的条件关系相关的概率联系起来。贝叶斯定理是贝叶斯滤波器的核心，我们将在第 4 章介绍该滤波器来解决定位问题，贝叶斯定理也是机器人专家用来处理不确定性的最重要工具之一。

概率分布是机器人技术中最重要的数学对象之一。然而，对于许多问题来说，概率分布过于复杂，难以精确表示，而且数学上操纵这些分布（例如，通过一系列动作向前传播不确定性）在计算上非常困难。在这种情况下，使用采样来近似概率分布会比较方便。具体来说，我们可以用一组样本来表示概率分布，每个样本都具有一个相关的权重。

基于采样的方法需要能够根据目标概率分布生成样本。几乎所有编程语言都包含某种类型的随机数生成器。其中最常见的随机数生成器会返回单位间隔内均匀分布的样本，但通常也有一些函数可以生成高斯分布的样本。对于其他类型的分布，可以使用我们将在第二章中介绍的方法编写自定义的随机样本生成器。由于能够根据任意分布生成随机样本，因此为不确定系统生成样本轨迹就变得非常简单。

我们还可以使用样本直接表示机器人在现实世界中移动时状态的概率分布。我们无需计算给定运动和测量不确定性模型的精确状态概率分布，而是可以从运动和测量概率分布中生成样本，并使用这些样本来更新与一组状态估计值相关的参数。这种方法被称为粒子滤波，我们将在第四章中介绍它，用于解决物流机器人的定位问题；每个状态估计值对应一个样本，该样本可以被视为一个粒子，而样本的相关权重是分配给特定状态值（或状态空间中特定的小区域）的概率质量的估计值。

我们还可以使用采样来构建机器人的路径和轨迹。例如，在第五章中，我们介绍了概率路线图 (PRM) 和快速探索随机树 (RRT)，用于寻找无碰撞路径。对于 PRM 和 RRT，路径规划都简化为在配置空间中生成随机样本，并将其与合适的局部路径连接起来的问题。在这些算法的原始版本中，样本是从均匀分布中抽取的，但多年来，已经提出了许多替代的采样方案。

统计学关注的是数据的分析和解释。例如，如果我们测量 100 块纸板垃圾的重量，那么平均重量是多少？如果真空吸尘器机器人尝试从客厅导航到厨房几次，它成功的概率是多少？如果激光雷达传感器对其视野范围内的物体返回多个距离测量值，这些数据相对于传感器返回的平均距离会如何变化？

概率论和统计学似乎关注的是同一件事——不确定性的表征和推理——但实际上，它们截然不同。概率论处理的是给定的数学对象（概率分布）；统计学处理的是观察到的数据。作为机器人专家，我们可以直接访问数据，但无法访问表征数据的底层概率模型。通常，后者要么 (a) 根据第一性原理估计，要么 (b) 使用数据估计。对于前者，我们可能知道在节日期间，许多人会打开礼物并将包装纸扔进垃圾桶，这会影响到达垃圾分类机器人的各种垃圾的概率。对于后者，激光雷达制造商可能会在严格控制和高度校准的环境中进行多次测量，并使用这些数据来估计激光雷达传感器的测量误差分布。

人们可能会怀疑，通过统计学方法使用数据来估计概率分布是否是一个好主意。事实上，概率论中有许多结果明确地解答了这个问题。其中一个例子就是弱大数定律，它（非正式地）指出，如果从某个概率分布中抽取数据值，那么随着数据集的增大，数据的平均值将趋向于相关随机变量的期望值。有许多相关的定理（有时称为极限定理），但它们通常具有相同的见解：随着数据集的规模变大，该数据集的统计数据将越来越能近似地描述生成该数据集的概率分布的各种属性。这一见解为许多概率方法在实践中的应用提供了理论基础。

图模型对于上述所有概念的表示、操作和计算都非常有用。除了采样之外，另一种建模复杂概率分布的方法是使用一种名为贝叶斯网络的图框架，我们认为它是建模感知和行动中不确定性的绝佳工具。另一方面，对于推理，我们引入了因子图，它更方便、更紧凑，可以在传感器测量可用且可作为条件时描述相对概率。

当我们尝试从数据中学习贝叶斯网络的参数时，图模型和统计学会结合在一起。如上所述，我们可以使用这些参数，通过转换为因子图，从测量数据中推断结果。或者，我们可以直接从贝叶斯网络中采样来模拟系统的行为。我们将遇到一种非常方便的算法——祖先采样（ancestral sampling），它可以轻松地应用于从任何贝叶斯网络中采样。例如，在第三章学习强化学习时，我们将使用祖先采样为我们的物流机器人生成样本轨迹。我们可以使用这些样本轨迹来计算未来时间范围内的预期性能。例如，为了评估候选控制策略的质量，我们可以生成大量的样本路径（或 rollout），并计算这些轨迹的平均成本（或奖励）。这提供了策略价值函数的近似值，价值函数是强化学习中的一个关键概念，它衡量从给定状态开始可以预期获得多少奖励。
